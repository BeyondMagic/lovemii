@use "sass:string";
@use "sass:map";

@function gtkalpha($c, $a) {
	@return string.unquote("alpha(#{$c},#{$a})");
}

@function color-var($name) {
	@return string.unquote("var(--#{$name})");
}

// Theme tokens for light and black variants
$themes: (
	light: (fg-color: #{"@theme_fg_color"},
		bg-color: #ffffff,
		error-color: #ff4d6d,
		button-hover-color: #fc7688,
		button-accent-color: #f0a6c8,
		workspace-empty-color: #a0a0a0,
		workspace-focus-color: #497f9e,
		workspace-hover-color: #fc7688,
		calendar-hover-color: #f0a6c8,
		calendar-border-color: #497f9e,
		overlay-darker: #00000011,
		overlay-darker-2: #00000022,
		overlay-lighter: #ffffff11),
	black: (fg-color: #f4f4f7,
		bg-color: #050505,
		error-color: #ff6b6b,
		button-hover-color: #ff8ba7,
		button-accent-color: #b48ef2,
		workspace-empty-color: #5a5a5a,
		workspace-focus-color: #7aa2f7,
		workspace-hover-color: #ff8ba7,
		calendar-hover-color: #b48ef2,
		calendar-border-color: #7aa2f7,
		overlay-darker: #ffffff0d,
		overlay-darker-2: #ffffff1a,
		overlay-lighter: #1a1a1a33)
);

@mixin theme-variables($selector, $theme) {
	#{$selector} {
		@each $name, $value in $theme {
			--#{$name}: #{$value};
		}
	}
}

@include theme-variables(":root", map.get($themes, black));
@include theme-variables(":root.theme-light", map.get($themes, light));
@include theme-variables(".theme-light", map.get($themes, light));
@include theme-variables(".theme-black", map.get($themes, black));

// Layout metrics
$radius-small: 8px;
$radius-medium: 12px;
$radius-large: 13px;

$spacing-xsmall: 0.2rem;
$spacing-small: 0.3rem;
$spacing-medium: 0.5rem;
$spacing-large: 1rem;

* {
	all: unset;
}

window#launcher {
	background: transparent;
	color: color-var("fg-color");

	>box {
		padding: 1.5rem;
		background: color-var("bg-color");
		min-width: 30rem;
		border-radius: $radius-medium;
		padding: $spacing-small;

		border-width: 1px;
		border-style: solid;
		border-color: color-var("overlay-darker-2");

		>entry {
			background-color: color-var("overlay-darker");

			padding: 0 0.5rem;
			border-radius: 0.5rem;

			>text {
				color: color-var("fg-color");

				>placeholder {
					color: color-var("overlay-darker-2");
				}
			}
		}

		>separator {
			min-height: 2px;
			background-color: color-var("overlay-darker");
		}

		>box {
			// background-color: yellow;

			>button {
				// background-color: pink;

				&:focus {
					background-color: color-var("overlay-darker-2");
				}

				>box {
					// background-color: orange;

					>.shortcut {
						min-width: 2rem;
						// background-color: purple;
					}
				}
			}
		}


	}
}

window.bar {
	background: transparent;
	color: color-var("fg-color");
	font-weight: bold;

	>centerbox {
		background: color-var("bg-color");
	}

	button {
		border: none;
		outline: none;
		background: none;
		color: inherit;
		border-radius: $radius-small;
		margin: 2px;
		color: color-var("fg-color");

		&:checked {
			color: color-var("button-hover-color");
		}

		&:focus {
			outline: none;
		}
	}

	.workspaces {

		.workspace {

			&.empty {
				color: color-var("workspace-empty-color");
			}

			&.focus {
				color: color-var("workspace-focus-color");
			}

			&:hover {
				color: color-var("workspace-hover-color");
			}

		}


	}

	.menu {

		.battery,
		.icon {
			&:hover {
				color: color-var("button-accent-color");
			}
		}
	}

	.tray-button {

		.icon {
			color: color-var("fg-color");

			&:hover {
				opacity: 0.8;
				color: color-var("button-accent-color");
			}
		}
	}
}

// calendar

popover.calendar {
	// box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);

	margin-top: 0.3rem;

	>arrow {
		border-width: 1px;
		border-style: solid;
		border-color: color-var("overlay-darker-2");

		background-color: color-var("bg-color");
	}


	/* Optional: for a shadow */
	>contents {
		border-width: 1px;
		border-style: solid;
		border-color: color-var("calendar-border-color");

		padding: 0.5rem;
		border-radius: 0.5rem;

		background-color: color-var("bg-color");

		>box {

			// Gtk separator
			>separator {
				background-color: color-var("overlay-darker");
				min-height: 2px;
			}

			>.navigation {

				padding: 0;

				>.section {

					padding: 0;
					// background-color: yellowgreen;

					>label {
						padding: 0;

						font-size: 1rem;
						font-weight: 400;
						font-family: 'Noto Sans CJK JP';
					}


					>button {
						padding: 0.65rem 0.8rem;

						&:hover {
							background-color: color-var("overlay-darker");
						}

						>label {
							padding: 0;
							font-size: 0.5rem;

						}
					}
				}
			}

			.days {

				font-family: 'Noto Sans CJK JP';

				>.row {
					padding: 0;

					label {

						padding: 0.25rem 0;
						margin: 0;
						border-radius: 0.2rem;
						font-weight: 500;

						&:hover {
							background-color: color-var("overlay-darker");
							color: color-var("fg-color");
						}

						&.inactive {
							color: gtkalpha(color-var("fg-color"), 0.3);
						}
					}

					&.header {
						label {
							&:hover {
								background-color: transparent;
								color: color-var("button-accent-color");
							}
						}
					}
				}
			}
		}


	}
}

// notification/

window.notifications {
	all: unset;
}

.notification {
	border-radius: $radius-large;
	background-color: color-var("bg-color");
	margin: $spacing-medium $spacing-large;
	box-shadow: 2px 3px 8px 0 gtkalpha(black, 0.4);
	border: 1pt solid gtkalpha(color-var("fg-color"), 0.03);

	&.critical {
		border: 1pt solid gtkalpha(color-var("error-color"), 0.4);

		.header {
			.app-name {
				color: gtkalpha(color-var("error-color"), 0.8);
			}

			.app-icon {
				color: gtkalpha(color-var("error-color"), 0.6);
			}
		}
	}

	.header {
		padding: $spacing-medium;
		color: gtkalpha(color-var("fg-color"), 0.5);

		.app-icon {
			margin: 0 0.4rem;
		}

		.app-name {
			margin-right: $spacing-small;
			font-weight: bold;

			&:first-child {
				margin-left: 0.4rem;
			}
		}

		.time {
			margin: 0 0.4rem;
		}

		button {
			padding: 0.2rem;
			min-width: 0;
			min-height: 0;
		}
	}

	separator {
		margin: 0 0.4rem;
		background-color: gtkalpha(color-var("fg-color"), 0.1);
	}

	.content {
		margin: $spacing-large;
		margin-top: $spacing-medium;

		.summary {
			font-size: 1.2em;
			color: color-var("fg-color");
		}

		.body {
			color: gtkalpha(color-var("fg-color"), 0.8);
		}

		.image {
			border: 1px solid gtkalpha(color-var("fg-color"), 0.02);
			margin-right: $spacing-medium;
			border-radius: 9px;
			min-width: 100px;
			min-height: 100px;
			background-size: cover;
			background-position: center;
		}
	}

	.actions {
		margin: $spacing-large;
		margin-top: 0;

		button {
			margin: 0 $spacing-small;

			&:first-child {
				margin-left: 0;
			}

			&:last-child {
				margin-right: 0;
			}
		}
	}
}